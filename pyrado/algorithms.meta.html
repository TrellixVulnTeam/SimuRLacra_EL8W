

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>meta &mdash; Pyrado 0.5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="exploration" href="exploration.html" />
    <link rel="prev" title="step_based" href="algorithms.step_based.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/panda3d_basic_experiment.html"><strong>How to create a visualization</strong></a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">meta</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.adr">adr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.arpl">arpl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bayessim">bayessim</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.bayrn">bayrn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.epopt">epopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.npdr">npdr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.sbi_base">sbi_base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.simopt">simopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.spota">spota</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.sprl">sprl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta.udr">udr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.meta">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>meta</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/algorithms.meta.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="meta">
<h1>meta<a class="headerlink" href="#meta" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.algorithms.meta.adr">
<span id="adr"></span><h2>adr<a class="headerlink" href="#module-pyrado.algorithms.meta.adr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.adr.ADR">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">ADR</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">pyrado.environments.base.Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_particle_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_svpg_particles</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_discriminator_epoch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_learning_rate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_temperature</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_evaluation_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_horizon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_kl_factor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_warmup</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svpg_serial</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trajs_per_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_step_length</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomized_params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Active Domain Randomization (ADR)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] B. Mehta, M. Diaz, F. Golemo, C.J. Pal, L. Paull, “Active Domain Randomization”, arXiv, 2019</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.ADR.compute_params">
<code class="sig-name descname"><span class="pre">compute_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_instances</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.compute_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.compute_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_instances</strong> – Physics configurations trajectory</p></li>
<li><p><strong>t</strong> – time step to chose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameters at the time</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.adr.ADR.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'adr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.ADR.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.ADR.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.ADR.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#ADR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.ADR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.meta.adr.RewardGenerator">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">RewardGenerator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_multiplier</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#RewardGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.RewardGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating the discriminator rewards in ADR. Generates a reward using a trained discriminator network.</p>
<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.RewardGenerator.get_reward">
<code class="sig-name descname"><span class="pre">get_reward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#RewardGenerator.get_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.RewardGenerator.get_reward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.RewardGenerator.train">
<code class="sig-name descname"><span class="pre">train</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_trajectory</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomized_trajectory</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epoch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#RewardGenerator.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.RewardGenerator.train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SVPGAdapter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrapped_env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">pyrado.environments.base.Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_parameter.DomainParam" title="pyrado.domain_randomization.domain_parameter.DomainParam"><span class="pre">pyrado.domain_randomization.domain_parameter.DomainParam</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">pyrado.policies.base.Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">discriminator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_length</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts_per_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">init_args_serializer.serializable.Serializable</span></code></p>
<p>Wrapper to encapsulate the domain parameter search as a reinforcement learning problem</p>
<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.act_space">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">act_space</span></code><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.act_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the space of the actions.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.array_to_dict">
<code class="sig-name descname"><span class="pre">array_to_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.array_to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.array_to_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.eval_states">
<code class="sig-name descname"><span class="pre">eval_states</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.eval_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.eval_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>states</strong> – the states to evaluate</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>respective rewards and according trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.lite_step">
<code class="sig-name descname"><span class="pre">lite_step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.lite_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.lite_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a step without the step interface.
This allows for parallel computation of prior steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>act</strong> – the action to perform</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the observation after the step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.nominal">
<code class="sig-name descname"><span class="pre">nominal</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.nominal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.nominal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.nominal_dict">
<code class="sig-name descname"><span class="pre">nominal_dict</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.nominal_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.nominal_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.obs_space">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">obs_space</span></code><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.obs_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the space of the observations (agent’s perception of the environment).</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.params">
<code class="sig-name descname"><span class="pre">params</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_state</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to its initial state and optionally set different domain parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_state</strong> – set explicit initial state if not None</p></li>
<li><p><strong>domain_param</strong> – set explicit domain parameters if not None</p></li>
</ul>
</dd>
<dt class="field-even">Return obs</dt>
<dd class="field-even"><p>initial observation of the state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.adr.SVPGAdapter.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">act</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">tuple</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#SVPGAdapter.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.SVPGAdapter.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one time step of the simulation. When a terminal condition is met, the reset function is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>act</strong> – action to be taken in the step</p>
</dd>
<dt class="field-even">Return tuple of obs, reward, done, and info</dt>
<dd class="field-even"><p>obs : current observation of the environment
reward: reward depending on the selected reward function
done: indicates whether the episode has ended
env_info: contains diagnostic information about the environment</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.meta.adr.convert_step_sequence">
<code class="sig-name descname"><span class="pre">convert_step_sequence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/adr.html#convert_step_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.adr.convert_step_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a StepSequence to a Tensor which can be fed through a Network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trajectory</strong> – A step sequence containing a trajectory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Tensor containing the trajectory</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.arpl">
<span id="arpl"></span><h2>arpl<a class="headerlink" href="#module-pyrado.algorithms.meta.arpl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.arpl.ARPL">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">ARPL</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">save_dir:</span> <span class="pre">PathLike,</span> <span class="pre">env:</span> <span class="pre">[&lt;class</span> <span class="pre">'pyrado.environments.sim_base.SimEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environment_wrappers.state_augmentation.StateAugmentationWrapper'&gt;],</span> <span class="pre">subrtn:</span> <span class="pre">pyrado.algorithms.base.Algorithm,</span> <span class="pre">policy:</span> <span class="pre">pyrado.policies.base.Policy,</span> <span class="pre">expl_strat:</span> <span class="pre">pyrado.exploration.stochastic_action.StochasticActionExplStrat,</span> <span class="pre">max_iter:</span> <span class="pre">int,</span> <span class="pre">num_rollouts:</span> <span class="pre">Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">steps_num:</span> <span class="pre">Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">apply_dynamics_noise:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">dyn_eps:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.01,</span> <span class="pre">dyn_phi:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.1,</span> <span class="pre">halfspan:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.25,</span> <span class="pre">apply_proccess_noise:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">proc_eps:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.01,</span> <span class="pre">proc_phi:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">apply_observation_noise:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">obs_eps:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.01,</span> <span class="pre">obs_phi:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05,</span> <span class="pre">torch_observation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4,</span> <span class="pre">logger:</span> <span class="pre">Optional[pyrado.logger.step.StepLogger]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a>, <a class="reference internal" href="sampling.html#pyrado.sampling.expose_sampler.ExposedSampler" title="pyrado.sampling.expose_sampler.ExposedSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.sampling.expose_sampler.ExposedSampler</span></code></a></p>
<p>Adversarially Robust Policy Learning (ARPL)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>A. Mandlekar, Y. Zhu, A. Garg, L. Fei-Fei, S. Savarese, “Adversarially Robust Policy Learning:
Active Construction of Physically-Plausible Perturbations”, IROS, 2017</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.meta.arpl.ARPL.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'arpl'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.arpl.ARPL.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.arpl.ARPL.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.arpl.ARPL.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/arpl.html#ARPL.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.arpl.ARPL.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="bayessim">
<h2>bayessim<a class="headerlink" href="#bayessim" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.algorithms.meta.bayrn">
<span id="bayrn"></span><h2>bayrn<a class="headerlink" href="#module-pyrado.algorithms.meta.bayrn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.bayrn.BayRn">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">BayRn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.real_base.RealEnv" title="pyrado.environments.real_base.RealEnv"><span class="pre">pyrado.environments.real_base.RealEnv</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddp_space</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="spaces.html#pyrado.spaces.box.BoxSpace" title="pyrado.spaces.box.BoxSpace"><span class="pre">pyrado.spaces.box.BoxSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_fc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_restarts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acq_param</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_init_cand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_estimator</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_rollouts_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_rollouts_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ_subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuefcn_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.InterruptableAlgorithm</span></code></a></p>
<p>Bayesian Domain Randomization (BayRn)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A candidate is a set of parameter values for the domain parameter distribution and its value is the
(estimated) real-world return.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>F. Muratore, C. Eilers, M. Gienger, J. Peters, “Bayesian Domain Randomization for Sim-to-Real Transfer”,
arXiv, 2020</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.argmax_posterior_mean">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">argmax_posterior_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cands</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cands_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddp_space</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="spaces.html#pyrado.spaces.box.BoxSpace" title="pyrado.spaces.box.BoxSpace"><span class="pre">pyrado.spaces.box.BoxSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_restarts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.argmax_posterior_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.argmax_posterior_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the GP input with the maximal posterior mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cands</strong> – candidates a.k.a. x</p></li>
<li><p><strong>cands_values</strong> – observed values a.k.a. y</p></li>
<li><p><strong>ddp_space</strong> – space of the domain distribution parameters, indicates the lower and upper bound</p></li>
<li><p><strong>num_restarts</strong> – number of restarts for the optimization of the acquisition function</p></li>
<li><p><strong>num_samples</strong> – number of samples for the optimization of the acquisition function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>un-normalized candidate with maximum posterior value a.k.a. x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.eval_init_policies">
<code class="sig-name descname"><span class="pre">eval_init_policies</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.eval_init_policies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.eval_init_policies" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the trained initial policies on the target device and store the estimated return per candidate.
The number of initial policies to evaluate is the number of found policies.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.eval_policy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">eval_policy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">save_dir:</span> <span class="pre">Optional[PathLike],</span> <span class="pre">env:</span> <span class="pre">[&lt;class</span> <span class="pre">'pyrado.environments.real_base.RealEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environments.sim_base.SimEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper'&gt;],</span> <span class="pre">policy:</span> <span class="pre">pyrado.policies.base.Policy,</span> <span class="pre">mc_estimator:</span> <span class="pre">bool,</span> <span class="pre">prefix:</span> <span class="pre">str,</span> <span class="pre">num_rollouts:</span> <span class="pre">int,</span> <span class="pre">num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4</span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.eval_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.eval_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a policy either in the source or in the target domain.
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – target environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>mc_estimator</strong> – estimate the return with a sample average (<cite>True</cite>) or a lower confidence
bound (<cite>False</cite>) obtained from bootrapping</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target system</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_workers</strong> – number of environments for the parallel sampler (only used for a <cite>SimEnv</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return in the target domain</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.iteration_key">
<code class="sig-name descname"><span class="pre">iteration_key</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'bayrn_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'bayrn'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.stopping_criterion_met">
<code class="sig-name descname"><span class="pre">stopping_criterion_met</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.stopping_criterion_met"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if one of the algorithms (characteristic) stopping criteria is met.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be overwritten by the subclasses to implement custom stopping behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag if one of the stopping criterion(s) is met</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.subroutine">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine</span></code><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.subroutine" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.train_argmax_policy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">train_argmax_policy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_restarts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuefcn_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'best'</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">pyrado.policies.base.Policy</span></a><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.train_argmax_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.train_argmax_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy based on the maximizer of the posterior mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – directory to load from</p></li>
<li><p><strong>env_sim</strong> – simulation environment</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>num_restarts</strong> – number of restarts for the optimization of the acquisition function</p></li>
<li><p><strong>num_samples</strong> – number of samples for the optimization of the acquisition function</p></li>
<li><p><strong>policy_param_init</strong> – initial policy parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>valuefcn_param_init</strong> – initial value function parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>subrtn_snapshot_mode</strong> – snapshot mode for saving during training of the subroutine</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the final BayRn policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.train_init_policies">
<code class="sig-name descname"><span class="pre">train_init_policies</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.train_init_policies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.train_init_policies" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm with a number of random distribution parameter sets a.k.a. candidates specified by
the user. Train a policy for every candidate. Finally, store the policies and candidates.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.bayrn.BayRn.train_policy_sim">
<code class="sig-name descname"><span class="pre">train_policy_sim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_rep</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/bayrn.html#BayRn.train_policy_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.bayrn.BayRn.train_policy_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – hyper-parameters for the domain parameter distribution (need be compatible with the randomizer)</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
<li><p><strong>cnt_rep</strong> – current repetition count, coming from the wrapper function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.epopt">
<span id="epopt"></span><h2>epopt<a class="headerlink" href="#module-pyrado.algorithms.meta.epopt" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.epopt.EPOpt">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">EPOpt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Ensemble Policy Optimization (EPOpt)</p>
<p>This algorithm wraps another algorithm on a shallow level. It replaces the subroutine’s sampler with a
<cite>CVaRSampler</cite>, but does not have its own logger.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A. Rajeswaran, S. Ghotra, B. Ravindran, S. Levine, “EPOpt: Learning Robust Neural Network Policies using
Model Ensembles”, ICLR, 2017</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.meta.epopt.EPOpt.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'epopt'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.epopt.EPOpt.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.epopt.EPOpt.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.epopt.EPOpt.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.epopt.EPOpt.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/epopt.html#EPOpt.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.epopt.EPOpt.subroutine">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine</span></code><a class="headerlink" href="#pyrado.algorithms.meta.epopt.EPOpt.subroutine" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.npdr">
<span id="npdr"></span><h2>npdr<a class="headerlink" href="#module-pyrado.algorithms.meta.npdr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.npdr.NPDR">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">NPDR</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">pyrado.environments.sim_base.SimEnv</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">pyrado.environments.base.Env</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">pyrado.policies.base.Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.distributions.distribution.Distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_class</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">sbi.inference.snpe.snpe_base.PosteriorEstimator</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">pyrado.sampling.sbi_embeddings.Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_real_rollouts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sim_per_round</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rec_act</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sbi_rounds</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_training_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_sampling_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_batch_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ_subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/npdr.html#NPDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.npdr.NPDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.meta.sbi_base.SBIBase" title="pyrado.algorithms.meta.sbi_base.SBIBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.meta.sbi_base.SBIBase</span></code></a></p>
<p>Neural Posterior Domain Randomization (NPDR)</p>
<dl class="py attribute">
<dt id="pyrado.algorithms.meta.npdr.NPDR.iteration_key">
<code class="sig-name descname"><span class="pre">iteration_key</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'npdr_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.npdr.NPDR.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.npdr.NPDR.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'npdr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.npdr.NPDR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.npdr.NPDR.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/npdr.html#NPDR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.npdr.NPDR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.sbi_base">
<span id="sbi-base"></span><h2>sbi_base<a class="headerlink" href="#module-pyrado.algorithms.meta.sbi_base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SBIBase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_checkpoints</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_checkpoint</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">pyrado.environments.sim_base.SimEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">pyrado.environments.base.Env</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">pyrado.policies.base.Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.distributions.distribution.Distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_class</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">sbi.inference.snpe.snpe_base.PosteriorEstimator</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">pyrado.sampling.sbi_embeddings.Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_real_rollouts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sim_per_round</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rec_act</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sbi_rounds</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_training_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_sampling_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_batch_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ_subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.InterruptableAlgorithm</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all Simulation-Based Inference (SBI) algorithms, wrapping the sbi package</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class currently only works with (direct) posterior estimators and currently excludes likelihood- and
density-ratio-estimators. This might be added later.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] <a class="reference external" href="https://github.com/mackelab/sbi/blob/main/tutorials/03_multiround_inference.ipynb">https://github.com/mackelab/sbi/blob/main/tutorials/03_multiround_inference.ipynb</a> (multi-round sbi)</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.collect_data_real">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">collect_data_real</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">pyrado.environments.base.Env</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">pyrado.policies.base.Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.sbi_embeddings.Embedding" title="pyrado.sampling.sbi_embeddings.Embedding"><span class="pre">pyrado.sampling.sbi_embeddings.Embedding</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_segments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.collect_data_real"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.collect_data_real" title="Permalink to this definition">¶</a></dt>
<dd><p>Roll-out a (behavioral) policy on the target system for later use with the sbi module, and save the data
computed from the recorded rollouts.
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – target environment for evaluation, in the sim-2-sim case this is another simulation instance,
in case you want to use pre-recorded rollouts pass the path to the parent folder as string</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>embedding</strong> – embedding used for pre-processing the data before passing it to the posterior</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target system</p></li>
<li><p><strong>num_segments</strong> – length of the segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>len_segments</strong> – length of the segments in which the rollouts are split into. For every segment, the initial
state of the simulation is reset, and thus for every set the features of the trajectories
are computed separately. Either specify <cite>num_segments</cite> or <cite>len_segments</cite>.</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data from the real-world rollouts a.k.a. set of <span class="math notranslate nohighlight">\(x_o\)</span> of shape [num_iter, num_rollouts_per_iter,
time_series_length, dim_data], and the real-world rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.embedding">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">embedding</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the embedding used to compute the features from the rollouts.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.eval_policy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">eval_policy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">PathLike</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env"><span class="pre">pyrado.environments.base.Env</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><span class="pre">pyrado.policies.base.Policy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.eval_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.eval_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a policy either in the source or in the target domain.
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – target environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target system</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_workers</strong> – number of environments for the parallel sampler (only used for SimEnv)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return in the target domain</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.eval_posterior">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">eval_posterior</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">sbi.inference.posteriors.direct_posterior.DirectPosterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_log_probs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_sampling_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.eval_posterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.eval_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the posterior by computing parameter samples given observed data, its log probability
and the simulated trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posterior</strong> – posterior to evaluate, e.g. a normalizing flow, that samples domain parameters conditioned on
the provided data</p></li>
<li><p><strong>data_real</strong> – data from the real-world rollouts a.k.a. set of <span class="math notranslate nohighlight">\(x_o\)</span> of shape
[num_iter, num_rollouts_per_iter, time_series_length, dim_data]</p></li>
<li><p><strong>num_samples</strong> – number of samples to draw from the posterior</p></li>
<li><p><strong>calculate_log_probs</strong> – if <cite>True</cite>, the log-probabilities are computed, else <cite>None</cite> is returned</p></li>
<li><p><strong>normalize_posterior</strong> – if <cite>True</cite>, the normalization of the posterior density is enforced by sbi</p></li>
<li><p><strong>subrtn_sbi_sampling_hparam</strong> – keyword arguments forwarded to sbi’s <cite>DirectPosterior.sample()</cite> function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>domain parameters sampled form the posterior of shape [batch_size, num_samples, dim_domain_param], as
well as the log-probabilities of these domain parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.fill_domain_param_buffer">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">fill_domain_param_buffer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapper"><span class="pre">pyrado.environment_wrappers.domain_randomization.DomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.fill_domain_param_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.fill_domain_param_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the environments domain parameter buffer according to the domain parameter map, and reset the ring index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment in which the domain parameters are inserted</p></li>
<li><p><strong>dp_mapping</strong> – mapping from subsequent integers (starting at 0) to domain parameter names (e.g. mass)</p></li>
<li><p><strong>domain_params</strong> – tensor of domain parameters [num_samples x dim domain param]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.get_latest_proposal">
<code class="sig-name descname"><span class="pre">get_latest_proposal</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">sbi.utils.torchutils.BoxUniform</span><span class="p"><span class="pre">,</span> </span><span class="pre">sbi.inference.posteriors.direct_posterior.DirectPosterior</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.get_latest_proposal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.get_latest_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the latest proposal. This is either the prior, or the (amortized) posterior from the previous iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>latest proposal for simulating with sbi</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.get_ml_posterior_samples">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_ml_posterior_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dp_mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">sbi.inference.posteriors.direct_posterior.DirectPosterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ml_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_log_probs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_sbi_sampling_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_as_tensor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.get_ml_posterior_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.get_ml_posterior_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the posterior conditioned on the data <cite>data_real</cite>, and extract the <cite>num_ml_samples</cite> most likely
domain parameter sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dp_mapping</strong> – mapping from subsequent integers (starting at 0) to domain parameter names (e.g. mass)</p></li>
<li><p><strong>posterior</strong> – posterior to evaluate, e.g. a normalizing flow, that samples domain parameters conditioned on
the provided data</p></li>
<li><p><strong>data_real</strong> – data from the real-world rollouts a.k.a. set of <span class="math notranslate nohighlight">\(x_o\)</span> of shape
[num_iter, num_rollouts_per_iter, time_series_length, dim_data]</p></li>
<li><p><strong>num_eval_samples</strong> – number of samples to draw from the posterior</p></li>
<li><p><strong>num_ml_samples</strong> – number of most likely samples, i.e. 1 equals argmax</p></li>
<li><p><strong>calculate_log_probs</strong> – if <cite>True</cite> the log-probabilities are computed, else <cite>None</cite> is returned</p></li>
<li><p><strong>normalize_posterior</strong> – if <cite>True</cite> the normalization of the posterior density is enforced by sbi</p></li>
<li><p><strong>subrtn_sbi_sampling_hparam</strong> – keyword arguments forwarded to sbi’s <cite>DirectPosterior.sample()</cite> function</p></li>
<li><p><strong>return_as_tensor</strong> – if <cite>True</cite>, return the most likely domain parameter sets as a tensor of shape
[num_iter, num_ml_samples, dim_domain_param], else as a list of <cite>dict</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>most likely domain parameters sets sampled form the posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.load_posterior">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">load_posterior</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_round</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">sbi.inference.posteriors.direct_posterior.DirectPosterior</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.load_posterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.load_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the posterior of a given iteration (and round).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – experiment’s directory to crawl through</p></li>
<li><p><strong>idx_iter</strong> – iteration to load, to load the latest pass -1</p></li>
<li><p><strong>idx_round</strong> – round to load, to load the latest pass -1, ignored if the experiment was not multi-round</p></li>
<li><p><strong>obj</strong> – object for state dict loading, forwarded to <cite>pyrado.load()</cite>, by default no state dict loading</p></li>
<li><p><strong>verbose</strong> – if <cite>True</cite>, print the path of what has been loaded, forwarded to <cite>pyrado.load()</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loaded sbi posterior, or <cite>None</cite> if there is no posterior with the given iteration / round index</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.sbi_simulator">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sbi_simulator</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.sbi_simulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the simulator wrapped for sbi.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.step">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.subroutine_policy">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine_policy</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.subroutine_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.subroutine_sbi">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine_sbi</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.subroutine_sbi" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the system identification subroutine coming from the sbi module.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sbi_base.SBIBase.train_policy_sim">
<code class="sig-name descname"><span class="pre">train_policy_sim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain_params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_rep</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sbi_base.html#SBIBase.train_policy_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sbi_base.SBIBase.train_policy_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain_params</strong> – domain parameters sampled from the posterior [shape N x D where N is the number of
samples and D is the number of domain parameters]</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
<li><p><strong>cnt_rep</strong> – current repetition count, coming from the wrapper function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.simopt">
<span id="simopt"></span><h2>simopt<a class="headerlink" href="#module-pyrado.algorithms.meta.simopt" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.simopt.SimOpt">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SimOpt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="environments.html#pyrado.environments.real_base.RealEnv" title="pyrado.environments.real_base.RealEnv"><span class="pre">pyrado.environments.real_base.RealEnv</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_distr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.episodic.html#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL"><span class="pre">pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_eval_rollouts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thold_succ_subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">-</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuefcn_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.InterruptableAlgorithm</span></code></a></p>
<p>Simulation Optimization (SimOpt)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A candidate is a set of parameter values for the domain parameter distribution and its value is the
discrepancy between the simulated and real observations (based on a weighted metric).</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] Y. SimOpt, A. Handa, V. Makoviychuk, M. Macklin, J. Issac, N.D. Ratliff, D. Fox, “Closing the Sim-to-Real
Loop: Adapting Simulation Randomization with Real World Experience”, ICRA, 2020</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.eval_behav_policy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">eval_behav_policy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">save_dir:</span> <span class="pre">[&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">None],</span> <span class="pre">env:</span> <span class="pre">[&lt;class</span> <span class="pre">'pyrado.environments.real_base.RealEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environments.sim_base.SimEnv'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper'&gt;],</span> <span class="pre">policy:</span> <span class="pre">pyrado.policies.base.Policy,</span> <span class="pre">prefix:</span> <span class="pre">str,</span> <span class="pre">num_rollouts:</span> <span class="pre">int,</span> <span class="pre">init_states:</span> <span class="pre">[&lt;class</span> <span class="pre">'numpy.ndarray'&gt;,</span> <span class="pre">None]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1001</span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.eval_behav_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.eval_behav_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a policy on the target system (real-world platform).
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target domain</p></li>
<li><p><strong>init_states</strong> – pass the initial states of the real system to sync the simulation (mandatory in this case)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, only used when evaluating in simulation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.eval_ddp_policy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">eval_ddp_policy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_sim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper"><span class="pre">pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rollouts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_distr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.episodic.html#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL"><span class="pre">pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_policy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.eval_ddp_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.eval_ddp_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the policy that fits the domain parameter distribution to the observed rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – recorded real-world rollouts</p></li>
<li><p><strong>env_sim</strong> – randomized simulation environment a.k.a. source domain</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target domain</p></li>
<li><p><strong>subrtn_distr</strong> – algorithm which performs the optimization of the domain parameter distribution policy</p></li>
<li><p><strong>subrtn_policy</strong> – algorithm which performs the optimization of the behavioral policy (and value-function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average system identification loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.iteration_key">
<code class="sig-name descname"><span class="pre">iteration_key</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'simopt_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'simopt'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.subroutine_distr">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine_distr</span></code><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.subroutine_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the system identification subroutine.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.subroutine_policy">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine_policy</span></code><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.subroutine_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.train_ddp_policy">
<code class="sig-name descname"><span class="pre">train_ddp_policy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts_real</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.train_ddp_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.train_ddp_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Train and evaluate the policy that parametrizes domain randomizer, such that the loss given by the instance of
<cite>SysIdViaEpisodicRL</cite> is minimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – recorded real-world rollouts</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average system identification loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.simopt.SimOpt.train_policy_sim">
<code class="sig-name descname"><span class="pre">train_policy_sim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_rep</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/simopt.html#SimOpt.train_policy_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.simopt.SimOpt.train_policy_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – hyper-parameters for the domain parameter distribution (need be compatible with the randomizer)</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name, use “” for no prefix</p></li>
<li><p><strong>cnt_rep</strong> – current repetition count, coming from the wrapper function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.spota">
<span id="spota"></span><h2>spota<a class="headerlink" href="#module-pyrado.algorithms.meta.spota" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.spota.SPOTA">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SPOTA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer"><span class="pre">pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_cand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn_refs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nG</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nJ</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntau</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nc_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_cand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_refs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart_cand</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmstart_refs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cand_policy_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cand_critic_param_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bs_reps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studentized_ci</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger"><span class="pre">pyrado.logger.step.StepLogger</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.InterruptableAlgorithm" title="pyrado.algorithms.base.InterruptableAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.InterruptableAlgorithm</span></code></a></p>
<p>Simulation-based Policy Optimization with Probability Assessment (SPOTA)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We use each domain parameter set <span class="math notranslate nohighlight">\(\xi_{j,nr}\)</span> for <span class="math notranslate nohighlight">\(n_{\tau}\)</span> rollouts.
The candidate and the reference policies must have the same architecture!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] F. Muratore, M. Gienger, J. Peters, “Assessing Transferability from Simulation to Reality for Reinforcement
Learning”, PAMI, 2019
[2] W. Mak, D.P. Morton, and R.K. Wood, “Monte Carlo bounding techniques for determining solution quality in
stochastic programs”, Oper. Res. Lett., 1999</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.meta.spota.SPOTA.iteration_key">
<code class="sig-name descname"><span class="pre">iteration_key</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'spota_iteration'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.meta.spota.SPOTA.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'spota'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.spota.SPOTA.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.spota.SPOTA.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.spota.SPOTA.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.spota.SPOTA.stopping_criterion_met">
<code class="sig-name descname"><span class="pre">stopping_criterion_met</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/spota.html#SPOTA.stopping_criterion_met"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the upper confidence bound on the optimality gap is smaller than the specified threshold.
.. note:: The UCBOG is equal to zero if all optimality gap samples are negative.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.spota.SPOTA.subroutine_cand">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine_cand</span></code><a class="headerlink" href="#pyrado.algorithms.meta.spota.SPOTA.subroutine_cand" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the candidate subroutine.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.sprl">
<span id="sprl"></span><h2>sprl<a class="headerlink" href="#module-pyrado.algorithms.meta.sprl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">MultivariateNormalWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_chol_flat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#MultivariateNormalWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A wrapper for PyTorch’s multivariate normal distribution with diagonal covariance.
It is used to get a SciPy optimizer-ready version of the parameters of a distribution,
i.e. a vector that can be used as the target variable.</p>
<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.cov">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">cov</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the covariance matrix, shape <cite>(k, k)</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.cov_chol_flat">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">cov_chol_flat</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.cov_chol_flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the standard deviations, i.e. the diagonal entries of the Cholesky decomposition of the covariance matrix,
shape <cite>(k,)</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dim</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size (dimensionality) of the random variable.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.from_stacked">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">from_stacked</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper" title="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper"><span class="pre">pyrado.algorithms.meta.sprl.MultivariateNormalWrapper</span></a><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#MultivariateNormalWrapper.from_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.from_stacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an instance of this class from the given stacked numpy array as generated e.g. by
<cite>MultivariateNormalWrapper.get_stacked(self)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> – dimensionality <cite>k</cite> of the random variable</p></li>
<li><p><strong>stacked</strong> – array containing the mean and standard deviations of shape <cite>(2 * k,)</cite>, where the first <cite>k</cite>
entries are the mean and the last <cite>k</cite> entries are the standard deviations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <cite>MultivariateNormalWrapper</cite> with the given mean/cov.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.get_stacked">
<code class="sig-name descname"><span class="pre">get_stacked</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#MultivariateNormalWrapper.get_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.get_stacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the numpy representations of the mean and standard deviations stacked on top of each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>stacked mean and standard deviations; shape <cite>(k,)</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.mean">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">mean</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mean.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.parameters">
<code class="sig-name descname"><span class="pre">parameters</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#MultivariateNormalWrapper.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameters (mean and standard deviations) of this distribution.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">ParameterAgnosticMultivariateNormalWrapper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_chol_flat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_is_parameter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_is_parameter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#ParameterAgnosticMultivariateNormalWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.meta.sprl.MultivariateNormalWrapper" title="pyrado.algorithms.meta.sprl.MultivariateNormalWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.meta.sprl.MultivariateNormalWrapper</span></code></a></p>
<p>Version of the <cite>MultivariateNormalWrapper</cite> that is able to exclude either the mean of the covariance from the
parameters and the stacking. This can be readily used for optimizing the mean or covariance while keeping the
other fixed.</p>
<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper.from_stacked">
<code class="sig-name descname"><span class="pre">from_stacked</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper" title="pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper"><span class="pre">pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper</span></a><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#ParameterAgnosticMultivariateNormalWrapper.from_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper.from_stacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a new <cite>ParameterAgnosticMultivariateNormalWrapper</cite> from the given stacked values. In contrast to
<cite>MultivariateNormalWrapper.from_stacked(dim, stacked)</cite>, this does not require a dimensionality as it is an
instance rather than a static method. Also, the stacked representations has to either contain the mean or the
standard deviations or both, according the the values originally passed to the constructor. If one of them is
not treated as a parameter, the current values is copied instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stacked</strong> – the stacked representation of the parameters according to the documentation above; can have
either shape <cite>(0,)</cite>, <cite>(k,)</cite>, or <cite>(2 * k)</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <cite>ParameterAgnosticMultivariateNormalWrapper</cite> with the new values for the parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper.get_stacked">
<code class="sig-name descname"><span class="pre">get_stacked</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_mean_cov_indices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#ParameterAgnosticMultivariateNormalWrapper.get_stacked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper.get_stacked" title="Permalink to this definition">¶</a></dt>
<dd><p>Like <cite>MultivariateNormalWrapper.get_stacked(self)</cite>, returns a numpy array with the mean and standard deviations
stacked on top of each other if the respective value is a parameter. Additionally, if <cite>return_mean_cov_indices</cite>
is <cite>True</cite>, also the indices of the mean/cov values are returned which can be used for addressing them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>return_mean_cov_indices</strong> – if <cite>True</cite>, additionally to just the parameters also the indices are returned</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if <cite>return_mean_cov_indices</cite> is <cite>True</cite>, a tuple <cite>(stacked, mean_indices, cov_indices)</cite>, where the
latter two might be <cite>None</cite> if the respective value is not a parameter; if <cite>return_mean_cov_indices</cite>
is <cite>False</cite>, just the stacked values; the stacked values can have shape <cite>(0,)</cite>, <cite>(k,)</cite>, or <cite>(2 * k,)</cite>,
depending on if none, only mean/cov, or both are parameters, respectively</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper.parameters">
<code class="sig-name descname"><span class="pre">parameters</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">None</span><span class="p"><span class="pre">,</span> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#ParameterAgnosticMultivariateNormalWrapper.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.ParameterAgnosticMultivariateNormalWrapper.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of parameters according to the values passed to the constructor.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.meta.sprl.SPRL">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SPRL</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapper"><span class="pre">pyrado.environment_wrappers.domain_randomization.DomainRandWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subroutine</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_constraints_ub</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">performance_lower_bound</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_lower_bound</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_threshold</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_cov</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_subrtn_retries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#SPRL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Self-Paced Reinforcement Leaner (SPRL)</p>
<p>This algorithm wraps another algorithm. The main purpose is to apply self-paced RL [1].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] P. Klink, H. Abdulsamad, B. Belousov, C. D’Eramo, J. Peters, and J. Pajarinen,
“A Probabilistic Interpretation of Self-Paced Learning with Applications to Reinforcement Learning”, arXiv, 2021</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.meta.sprl.SPRL.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'sprl'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.SPRL.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#SPRL.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.SPRL.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.SPRL.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#SPRL.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.SPRL.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/sprl.html#SPRL.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a step of SPRL. This includes training the subroutine and updating the context distribution accordingly.
For a description of the parameters see <cite>pyrado.algorithms.base.Algorithm.step</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.sprl.SPRL.sub_algorithm">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sub_algorithm</span></code><a class="headerlink" href="#pyrado.algorithms.meta.sprl.SPRL.sub_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta.udr">
<span id="udr"></span><h2>udr<a class="headerlink" href="#module-pyrado.algorithms.meta.udr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.meta.udr.UDR">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">UDR</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subrtn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><span class="pre">pyrado.algorithms.base.Algorithm</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Uniform Domain Randomization (UDR)</p>
<p>This algorithm barely wraps another algorithm. The main purpose is to check if the domain randomizer is set up.</p>
<dl class="py attribute">
<dt id="pyrado.algorithms.meta.udr.UDR.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'udr'</span></em><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.udr.UDR.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.udr.UDR.sample_count">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">sample_count</span></code><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.udr.UDR.save_snapshot">
<code class="sig-name descname"><span class="pre">save_snapshot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.save_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.udr.UDR.step">
<code class="sig-name descname"><span class="pre">step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snapshot_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/meta/udr.html#UDR.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.meta.udr.UDR.subroutine">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">subroutine</span></code><a class="headerlink" href="#pyrado.algorithms.meta.udr.UDR.subroutine" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy optimization subroutine.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.meta">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms.meta" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="exploration.html" class="btn btn-neutral float-right" title="exploration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="algorithms.step_based.html" class="btn btn-neutral float-left" title="step_based" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>