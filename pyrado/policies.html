

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>policies &mdash; Pyrado 0.4 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="feed_forward" href="policies.feed_forward.html" />
    <link rel="prev" title="tasks" href="tasks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">policies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.base">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.features">features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.initialization">initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>policies</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/policies.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="policies">
<h1>policies<a class="headerlink" href="#policies" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="module-pyrado.policies.base">
<span id="base"></span><h2>base<a class="headerlink" href="#module-pyrado.policies.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.base.Policy">
<em class="property">class </em><code class="sig-name descname">Policy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#Policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all policies in Pyrado</p>
<dl class="py method">
<dt id="pyrado.policies.base.Policy.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#pyrado.policies.base.Policy.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the device (CPU or GPU) on which the policy is stored.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.env_spec">
<em class="property">property </em><code class="sig-name descname">env_spec</code><a class="headerlink" href="#pyrado.policies.base.Policy.env_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the specification of environment the policy acts in.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
The default implementation simply calls <cite>forward()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Defaults to ‘hidden_states’. Change for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘torch.Tensor’&gt;, (&lt;class ‘torch.Tensor’&gt;, &lt;class ‘torch.Tensor’&gt;)]<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.init_hidden">
<code class="sig-name descname">init_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.init_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.init_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide initial values for the hidden parameters. This should usually be a zero tensor.
The default implementation will raise an error, to enforce override this function for recurrent policies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of states to track in parallel</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of batch_size x hidden_size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.init_param">
<em class="property">abstract </em><code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.is_recurrent">
<em class="property">property </em><code class="sig-name descname">is_recurrent</code><a class="headerlink" href="#pyrado.policies.base.Policy.is_recurrent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bool to signalise it the policy has a recurrent architecture.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.Policy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#pyrado.policies.base.Policy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.num_param">
<em class="property">property </em><code class="sig-name descname">num_param</code><a class="headerlink" href="#pyrado.policies.base.Policy.num_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of policy parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.param_grad">
<em class="property">property </em><code class="sig-name descname">param_grad</code><a class="headerlink" href="#pyrado.policies.base.Policy.param_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the gradient of the parameters as 1d array.
The values are copied, modifying the return value does not propagate to the actual policy parameters.
However, setting this variable will change the gradient.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.param_values">
<em class="property">property </em><code class="sig-name descname">param_values</code><a class="headerlink" href="#pyrado.policies.base.Policy.param_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameters of the policy as 1d array.
The values are copied, modifying the return value does not propagate to the actual policy parameters.
However, setting this variable will change the parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the policy to it’s initial state.
This should be called at the start of a rollout. Stateful policies should use it to reset the state variables.
The default implementation does nothing.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.script">
<code class="sig-name descname">script</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.jit._script.ScriptModule<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.script"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.script" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScriptModule from this policy.
The returned module will always have the signature <cite>action = tm(observation)</cite>.
For recurrent networks, it returns a stateful module that keeps the hidden states internally.
Such modules have a reset() method to reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.base.TracedPolicyWrapper">
<em class="property">class </em><code class="sig-name descname">TracedPolicyWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">module</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#TracedPolicyWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper for a traced policy. Mainly used to add <cite>input_size</cite> and <cite>output_size</cite> attributes.</p>
<dl class="py method">
<dt id="pyrado.policies.base.TracedPolicyWrapper.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#TracedPolicyWrapper.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.TracedPolicyWrapper.input_size">
<code class="sig-name descname">input_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper.input_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.TracedPolicyWrapper.output_size">
<code class="sig-name descname">output_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.base.TwoHeadedPolicy">
<em class="property">class </em><code class="sig-name descname">TwoHeadedPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#TwoHeadedPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TwoHeadedPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for policies with a shared body and two separate heads.</p>
<dl class="py method">
<dt id="pyrado.policies.base.TwoHeadedPolicy.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘torch.Tensor’&gt;, (&lt;class ‘torch.Tensor’&gt;, &lt;class ‘torch.Tensor’&gt;)]<a class="reference internal" href="_modules/pyrado/policies/base.html#TwoHeadedPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TwoHeadedPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.TwoHeadedPolicy.init_param">
<em class="property">abstract </em><code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#TwoHeadedPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TwoHeadedPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.TwoHeadedPolicy.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#pyrado.policies.base.TwoHeadedPolicy.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.features">
<span id="features"></span><h2>features<a class="headerlink" href="#module-pyrado.policies.features" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.features.ATan2Feat">
<em class="property">class </em><code class="sig-name descname">ATan2Feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx_sin</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">idx_cos</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#ATan2Feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.ATan2Feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Feature that computes the atan2 from two dimensions of the given input / observation.</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.FeatureStack">
<em class="property">class </em><code class="sig-name descname">FeatureStack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">feat_fcns</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>Callable<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#FeatureStack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.FeatureStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Features are nonlinear transformations of the inputs.
.. note:: We only consider 1-dim measurements, i.e. no images.</p>
<dl class="py method">
<dt id="pyrado.policies.features.FeatureStack.get_num_feat">
<code class="sig-name descname">get_num_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_flat_dim</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/pyrado/policies/features.html#FeatureStack.get_num_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.FeatureStack.get_num_feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the number of features which depends on the dimension of the input and the selected feature functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp_flat_dim</strong> – flattened dimension input to the feature functions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of feature values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.MultFeat">
<em class="property">class </em><code class="sig-name descname">MultFeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idcs</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>int<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#MultFeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.MultFeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Feature that multiplies two dimensions of the given input / observation</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.RBFFeat">
<em class="property">class </em><code class="sig-name descname">RBFFeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_feat_per_dim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">bounds</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Sequence<span class="p">[</span>list<span class="p">]</span><span class="p">, </span>typing.Sequence<span class="p">[</span>tuple<span class="p">]</span><span class="p">, </span>typing.Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span><span class="p">, </span>typing.Sequence<span class="p">[</span>torch.Tensor<span class="p">]</span><span class="p">, </span>typing.Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">state_wise_norm</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#RBFFeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.RBFFeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalized Gaussian radial basis function features</p>
<dl class="py method">
<dt id="pyrado.policies.features.RBFFeat.derivative">
<code class="sig-name descname">derivative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/features.html#RBFFeat.derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.RBFFeat.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivative of the features w.r.t. the inputs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only processing of 1-dim input (e.g., no images)! The input can be batched along the first dimension.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp</strong> – input i.e. observations in the RL setting</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value of all features derivatives given the observations</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.RandFourierFeat">
<em class="property">class </em><code class="sig-name descname">RandFourierFeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_dim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_feat_per_dim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">bandwidth</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#RandFourierFeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.RandFourierFeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Fourier features</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A. Rahimi and B. Recht “Random Features for Large-Scale Kernel Machines”, NIPS, 2007</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.abs_feat">
<code class="sig-name descname">abs_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#abs_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.abs_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.bell_feat">
<code class="sig-name descname">bell_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#bell_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.bell_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.const_feat">
<code class="sig-name descname">const_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#const_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.const_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.cos_feat">
<code class="sig-name descname">cos_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#cos_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.cos_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.cubic_feat">
<code class="sig-name descname">cubic_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#cubic_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.cubic_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.identity_feat">
<code class="sig-name descname">identity_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#identity_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.identity_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sig_feat">
<code class="sig-name descname">sig_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sig_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sig_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sign_feat">
<code class="sig-name descname">sign_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sign_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sign_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sin_feat">
<code class="sig-name descname">sin_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sin_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sin_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sincos_feat">
<code class="sig-name descname">sincos_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sincos_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sincos_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sinsin_feat">
<code class="sig-name descname">sinsin_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sinsin_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sinsin_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.squared_feat">
<code class="sig-name descname">squared_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#squared_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.squared_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyrado.policies.initialization">
<span id="initialization"></span><h2>initialization<a class="headerlink" href="#module-pyrado.policies.initialization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.policies.initialization.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/initialization.html#init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.initialization.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the parameters of the PyTorch Module / layer / network / cell according to its type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – PyTorch Module / layer / network / cell to initialize</p></li>
<li><p><strong>kwargs</strong> – optional keyword arguments, e.g. <cite>t_max</cite> for LSTM’s chrono initialization [2], or <cite>uniform_bias</cite></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A.M. Sachse, J. L. McClelland, S. Ganguli, “Exact solutions to the nonlinear dynamics of learning in
deep linear neural networks”, 2014</p>
<p>[2] C. Tallec, Y. Ollivier, “Can recurrent neural networks warp time?”, 2018, ICLR</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrado.policies">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.policies" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="policies.feed_forward.html" class="btn btn-neutral float-right" title="feed_forward" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tasks.html" class="btn btn-neutral float-left" title="tasks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>