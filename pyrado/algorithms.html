

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>algorithms &mdash; Pyrado 0.4 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="episodic" href="algorithms.episodic.html" />
    <link rel="prev" title="How to create an algorithm" href="examples/3_algorithm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_environment_wrappers.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.base">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.timeseries_prediction">timeseries_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.utils">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/algorithms.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="algorithms">
<h1>algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="module-pyrado.algorithms.base">
<span id="base"></span><h2>base<a class="headerlink" href="#module-pyrado.algorithms.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.base.Algorithm">
<em class="property">class </em><code class="sig-name descname">Algorithm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'algo'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.logger.step.LoggerAware</span></code></a></p>
<p>Base class of all algorithms in Pyrado
Algorithms specify the way how the policy is updated as well as the exploration strategy used to acquire samples.</p>
<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.clip_grad">
<em class="property">static </em><code class="sig-name descname">clip_grad</code><span class="sig-paren">(</span><em class="sig-param">module: torch.nn.modules.module.Module, max_grad_norm: [&lt;class 'float'&gt;, None]</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.clip_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.clip_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip all gradients of the provided Module (e.g., a policy or an advantage estimator) by their L2 norm value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The gradient clipping has to be applied between loss.backward() and optimizer.step()</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> – Module containing parameters</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm for the gradient</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>total norm of the parameters (viewed as a single vector)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.curr_iter">
<em class="property">property </em><code class="sig-name descname">curr_iter</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.curr_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current iteration counter.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>prefix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.base.Algorithm.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'iteration'</em><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.load_snapshot">
<em class="property">static </em><code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">load_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'algo'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an algorithm from file, i.e. unpickle it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – experiment directory to load from</p></li>
<li><p><strong>load_name</strong> – name of the algorithm’s pickle file without the ending</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.make_snapshot">
<code class="sig-name descname">make_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">curr_avg_ret</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.make_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.make_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a snapshot of the training progress.
This method is called from the subclasses and delegates to the custom method <cite>save_snapshot()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>curr_avg_ret</strong> – current average return used for the snapshot_mode ‘best’ to trigger <cite>save_snapshot()</cite></p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.max_iter">
<em class="property">property </em><code class="sig-name descname">max_iter</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.max_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the maximum number of iterations.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.base.Algorithm.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.policy">
<em class="property">property </em><code class="sig-name descname">policy</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s policy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.sample_count">
<em class="property">property </em><code class="sig-name descname">sample_count</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.sample_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples, i.e. steps of a rollout, used for training so far.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_dir">
<em class="property">property </em><code class="sig-name descname">save_dir</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the directory where the data is saved to.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_name">
<em class="property">property </em><code class="sig-name descname">save_name</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name for saving this algorithm instance, e.g. ‘algo’ if saved to ‘algo.pkl’.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.step">
<em class="property">abstract </em><code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if one of the algorithms (characteristic) stopping criterions is met.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be overwritten by the subclasses to implement custom stopping behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag if one of the stopping criterion(s) is met</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'latest'</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train one/multiple policy/policies in a given environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new high-score)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy’s (and value functions’) parameters based on the collected rollout data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.base.InterruptableAlgorithm">
<em class="property">class </em><code class="sig-name descname">InterruptableAlgorithm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_checkpoints</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">init_checkpoint</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#InterruptableAlgorithm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.InterruptableAlgorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>A simple checkpoint system too keep track of the algorithms progress. The cyclic counter starts at <cite>init_checkpoint</cite>
and counts until (including) <cite>num_checkpoints</cite>, and is then reset to zero.</p>
<dl class="py method">
<dt id="pyrado.algorithms.base.InterruptableAlgorithm.curr_checkpoint">
<em class="property">property </em><code class="sig-name descname">curr_checkpoint</code><a class="headerlink" href="#pyrado.algorithms.base.InterruptableAlgorithm.curr_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current checkpoint counter.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.InterruptableAlgorithm.reached_checkpoint">
<code class="sig-name descname">reached_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#InterruptableAlgorithm.reached_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.InterruptableAlgorithm.reached_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Increase the cyclic counter by 1. When the counter reached the maximum number of checkpoints, defined in the
constructor, it is automatically reset to zero.
This method also saves the algorithm instance using <cite>save_snapshot()</cite>, otherwise increasing the checkpoint
counter can have no effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – information forwarded to <cite>save_snapshot()</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.InterruptableAlgorithm.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#InterruptableAlgorithm.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.InterruptableAlgorithm.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.InterruptableAlgorithm.reset_checkpoint">
<code class="sig-name descname">reset_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">curr</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#InterruptableAlgorithm.reset_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.InterruptableAlgorithm.reset_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicitly reset the cyclic counter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>curr</strong> – value to set the counter to, defaults to 0</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.timeseries_prediction">
<span id="timeseries-prediction"></span><h2>timeseries_prediction<a class="headerlink" href="#module-pyrado.algorithms.timeseries_prediction" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred">
<em class="property">class </em><code class="sig-name descname">TSPred</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">dataset: pyrado.utils.data_sets.TimeSeriesDataSet</em>, <em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">windowed: bool = False</em>, <em class="sig-param">cascaded: bool = False</em>, <em class="sig-param">optim_class=&lt;class 'torch.optim.adam.Adam'&gt;</em>, <em class="sig-param">optim_hparam: Optional[dict] = None</em>, <em class="sig-param">loss_fcn=MSELoss()</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: Optional[dict] = None</em>, <em class="sig-param">num_workers: int = 1</em>, <em class="sig-param">logger: Optional[pyrado.logger.step.StepLogger] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Train a policy to predict a time series of data.</p>
<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.evaluate">
<em class="property">static </em><code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">inps</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">targs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">windowed</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">cascaded</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">num_init_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">hidden</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loss_fcn</span><span class="o">=</span><span class="default_value">MSELoss()</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'tspred'</em><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.predict">
<em class="property">static </em><code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">inp_seq: torch.Tensor</em>, <em class="sig-param">windowed: bool</em>, <em class="sig-param">cascaded: bool</em>, <em class="sig-param">hidden: Optional[torch.Tensor] = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the hidden states, predict one output given a arbitrary long sequence of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy</strong> – policy used to make the predictions</p></li>
<li><p><strong>inp_seq</strong> – input sequence</p></li>
<li><p><strong>hidden</strong> – initial hidden states, pass <cite>None</cite> to let the network pick its default hidden state</p></li>
<li><p><strong>windowed</strong> – if <cite>True</cite>, one fixed-length (short) input sequence is provided to the policy which then
predicts one sample, else the complete (long) input sequence is fed to the policy which then
predicts an sequence of samples of equal length</p></li>
<li><p><strong>cascaded</strong> – it <cite>True</cite>, the predictions are made based on previous predictions instead of the current input</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted output and latest hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-pyrado.algorithms.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.utils.ActionStatistics">
<em class="property">class </em><code class="sig-name descname">ActionStatistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">act_distr</span><span class="p">:</span> <span class="n">torch.distributions.distribution.Distribution</span></em>, <em class="sig-param"><span class="n">log_probs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">entropy</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ActionStatistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>act_distr: probability distribution at the given policy output values
log_probs: <span class="math notranslate nohighlight">\(\log (p(act|obs, hidden))\)</span> if hidden exists, else <span class="math notranslate nohighlight">\(\log (p(act|obs))\)</span>
entropy: entropy of the action distribution</p>
<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.act_distr">
<em class="property">property </em><code class="sig-name descname">act_distr</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.act_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.entropy">
<em class="property">property </em><code class="sig-name descname">entropy</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.log_probs">
<em class="property">property </em><code class="sig-name descname">log_probs</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.log_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.utils.ReplayMemory">
<em class="property">class </em><code class="sig-name descname">ReplayMemory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for storing step transitions</p>
<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.avg_reward">
<code class="sig-name descname">avg_reward</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.avg_reward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.avg_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average reward for all steps stored in the replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>average reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.isempty">
<em class="property">property </em><code class="sig-name descname">isempty</code><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.isempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the replay buffer is empty.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the replay buffer.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.push">
<code class="sig-name descname">push</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ros</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">truncate_last</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.push"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a sequence of steps and drop of steps if the capacity is exceeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ros</strong> – list of rollouts or one concatenated rollout</p></li>
<li><p><strong>truncate_last</strong> – remove the last step from each rollout, forwarded to <cite>StepSequence.concat</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample randomly from the replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of samples</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple of transition steps and associated next steps</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.compute_action_statistics">
<code class="sig-name descname">compute_action_statistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">steps</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">expl_strat</span><span class="p">:</span> <span class="n"><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.StochasticActionExplStrat" title="pyrado.exploration.stochastic_action.StochasticActionExplStrat">pyrado.exploration.stochastic_action.StochasticActionExplStrat</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyrado.algorithms.utils.ActionStatistics" title="pyrado.algorithms.utils.ActionStatistics">pyrado.algorithms.utils.ActionStatistics</a><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#compute_action_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.compute_action_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action distribution from the exploration strategy, compute the log action probabilities and entropy
for the given rollout using the given exploration strategy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires the exploration strategy to have a (most likely custom) <cite>evaluate()</cite> method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>steps</strong> – recorded rollout data</p></li>
<li><p><strong>expl_strat</strong> – exploration strategy used to generate the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>collected action statistics, see <cite>ActionStatistics</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.get_grad_via_torch">
<code class="sig-name descname">get_grad_via_torch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_np</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">fcn_to</span><span class="p">:</span> <span class="n">Callable</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args_to</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs_to</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#get_grad_via_torch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.get_grad_via_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the gradient of a function operating on PyTorch tensors, by casting the input <cite>x_np</cite> as well as the
resulting gradient to PyTorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_np</strong> – input vector <span class="math notranslate nohighlight">\(x\)</span></p></li>
<li><p><strong>fcn_to</strong> – function <span class="math notranslate nohighlight">\(f(x, \cdot)\)</span></p></li>
<li><p><strong>args_to</strong> – other arguments to the function</p></li>
<li><p><strong>kwargs_to</strong> – other keyword arguments to the function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(\nabla_x f(x, \cdot)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.num_iter_from_rollouts">
<code class="sig-name descname">num_iter_from_rollouts</code><span class="sig-paren">(</span><em class="sig-param">ros: [typing.Sequence[pyrado.sampling.step_sequence.StepSequence], None], concat_ros: [&lt;class 'pyrado.sampling.step_sequence.StepSequence'&gt;, None], batch_size: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#num_iter_from_rollouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.num_iter_from_rollouts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of iterations from the given rollout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ros</strong> – multiple rollouts</p></li>
<li><p><strong>concat_ros</strong> – concatenated rollouts</p></li>
<li><p><strong>batch_size</strong> – number of samples per batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of iterations (e.g. used for the progress bar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.until_thold_exceeded">
<code class="sig-name descname">until_thold_exceeded</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">thold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#until_thold_exceeded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.until_thold_exceeded" title="Permalink to this definition">¶</a></dt>
<dd><p>Designed to wrap a function and repeat it until the return value exceeds a threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thold</strong> – threshold</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations of the wrapped function, set to <cite>None</cite> to run the loop relentlessly</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wrapped function</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="algorithms.episodic.html" class="btn btn-neutral float-right" title="episodic" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="examples/3_algorithm.html" class="btn btn-neutral float-left" title="How to create an algorithm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>