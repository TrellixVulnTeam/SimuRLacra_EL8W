

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>special &mdash; Pyrado 0.5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="logger" href="logger.html" />
    <link rel="prev" title="recurrent" href="policies.recurrent.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/4_creating_rcspysim_environments.html">How to create an RcsPySim environment</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.episodic.html">episodic</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">special</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.domain_distribution">domain_distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.dual_rfb">dual_rfb</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.dummy">dummy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.environment_specific">environment_specific</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.mdn">mdn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special.time">time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.special">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>special</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/policies.special.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="special">
<h1>special<a class="headerlink" href="#special" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.policies.special.domain_distribution">
<span id="domain-distribution"></span><h2>domain_distribution<a class="headerlink" href="#module-pyrado.policies.special.domain_distribution" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">DomainDistrParamPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trafo_mask</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_randomizer.DomainRandomizer" title="pyrado.domain_randomization.domain_randomizer.DomainRandomizer"><span class="pre">pyrado.domain_randomization.domain_randomizer.DomainRandomizer</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>A proxy to the Policy class in order to use the policy’s parameters as domain distribution parameters</p>
<dl class="py method">
<dt id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.mapping">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">mapping</span></code><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mapping from subsequent integers to domain distribution parameters, where the first string of the value
tuple is the name of the domain parameter and the second string is the name of the distribution parameter.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'ddp'</span></em><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space">
<code class="sig-name descname"><span class="pre">transform_to_ddp_space</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/domain_distribution.html#DomainDistrParamPolicy.transform_to_ddp_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transformed domain distribution parameters. Where ever the mask is <cite>True</cite>, the corresponding policy
parameter is learned in sqrt space. Moreover, the policy parameters can be scaled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> – policy parameters (can be the sqrt of the actual domain distribution parameter value)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>policy parameters transformed according to the mask</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.special.dual_rfb">
<span id="dual-rfb"></span><h2>dual_rfb<a class="headerlink" href="#module-pyrado.policies.special.dual_rfb" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.special.dual_rfb.DualRBFLinearPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">DualRBFLinearPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbf_hparam</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_mask</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_param_kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dual_rfb.html#DualRBFLinearPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dual_rfb.DualRBFLinearPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.feed_forward.html#pyrado.policies.feed_forward.linear.LinearPolicy" title="pyrado.policies.feed_forward.linear.LinearPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.feed_forward.linear.LinearPolicy</span></code></a></p>
<p>A linear policy with RBF features which are also used to get the derivative of the features. The use-case in mind
is a simple policy which generates the joint position and joint velocity commands for the internal PD-controller
of a robot (e.g. Barrett WAM). By re-using the RBF, we reduce the number of parameters, while we can at the same
time get the velocity information from the features, i.e. the derivative of the normalized Gaussians.</p>
<dl class="py method">
<dt id="pyrado.policies.special.dual_rfb.DualRBFLinearPolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/dual_rfb.html#DualRBFLinearPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dual_rfb.DualRBFLinearPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the features at the given observation or use given feature values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observations from the environment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.dual_rfb.DualRBFLinearPolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'dualrbf'</span></em><a class="headerlink" href="#pyrado.policies.special.dual_rfb.DualRBFLinearPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.special.dummy">
<span id="dummy"></span><h2>dummy<a class="headerlink" href="#module-pyrado.policies.special.dummy" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.special.dummy.DummyPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">DummyPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#DummyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.DummyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Simple policy which samples random values form the action space</p>
<dl class="py method">
<dt id="pyrado.policies.special.dummy.DummyPolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#DummyPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.DummyPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.dummy.DummyPolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#DummyPolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.DummyPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.dummy.DummyPolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'dummy'</span></em><a class="headerlink" href="#pyrado.policies.special.dummy.DummyPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.dummy.IdlePolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">IdlePolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#IdlePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.IdlePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>The most simple policy which simply does nothing</p>
<dl class="py method">
<dt id="pyrado.policies.special.dummy.IdlePolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#IdlePolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.IdlePolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.dummy.IdlePolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#IdlePolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.IdlePolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.dummy.IdlePolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'idle'</span></em><a class="headerlink" href="#pyrado.policies.special.dummy.IdlePolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.dummy.RecurrentDummyPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">RecurrentDummyPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#RecurrentDummyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.RecurrentDummyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.recurrent.html#pyrado.policies.recurrent.base.RecurrentPolicy" title="pyrado.policies.recurrent.base.RecurrentPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.recurrent.base.RecurrentPolicy</span></code></a></p>
<p>Simple recurrent policy which samples random values form the action space and
always returns hidden states with value zero</p>
<dl class="py method">
<dt id="pyrado.policies.special.dummy.RecurrentDummyPolicy.evaluate">
<code class="sig-name descname"><span class="pre">evaluate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence"><span class="pre">pyrado.sampling.step_sequence.StepSequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_states_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'hidden_states'</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#RecurrentDummyPolicy.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.RecurrentDummyPolicy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
This method makes sure that the gradient is propagated through the hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Change this string for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.dummy.RecurrentDummyPolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">obs:</span> <span class="pre">Optional[torch.Tensor]</span> <span class="pre">=</span> <span class="pre">None</span></em>, <em class="sig-param"><span class="pre">hidden:</span> <span class="pre">Optional[torch.Tensor]</span> <span class="pre">=</span> <span class="pre">None)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></em>, <em class="sig-param"><span class="pre">&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#RecurrentDummyPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.RecurrentDummyPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observation from the environment</p></li>
<li><p><strong>hidden</strong> – the network’s hidden state. If None, use init_hidden()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action to be taken and new hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.dummy.RecurrentDummyPolicy.hidden_size">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">hidden_size</span></code><a class="headerlink" href="#pyrado.policies.special.dummy.RecurrentDummyPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.dummy.RecurrentDummyPolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/dummy.html#RecurrentDummyPolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.dummy.RecurrentDummyPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.dummy.RecurrentDummyPolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'rec_cummy'</span></em><a class="headerlink" href="#pyrado.policies.special.dummy.RecurrentDummyPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.special.environment_specific">
<span id="environment-specific"></span><h2>environment_specific<a class="headerlink" href="#module-pyrado.policies.special.environment_specific" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QBallBalancerPDCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_des</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">tensor([0.0,</span> <span class="pre">0.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>PD-controller for the Quanser Ball Balancer.
The only but significant difference of this controller to the other PD controller is the clipping of the actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class’s desired state specification deviates from the Pyrado policies which interact with a <cite>Task</cite>.</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the controller output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>controller output [V]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize controller parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kp</strong> – 2x2 tensor of constant controller feedback coefficients for error [V/m]</p></li>
<li><p><strong>kd</strong> – 2x2 tensor of constant controller feedback coefficients for error time derivative [Vs/m]</p></li>
<li><p><strong>verbose</strong> – print the controller’s gains</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'qbb-pd'</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_des</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QBallBalancerPDCtrl.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QBallBalancerPDCtrl.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the controller’s desired state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_des</strong> – tensor of desired x and y ball position [m], or None to keep the current desired state</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QCartPoleGoToLimCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QCartPoleGoToLimCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_state</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleGoToLimCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleGoToLimCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Controller for going to one of the joint limits (part of the calibration routine)</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QCartPoleSwingUpAndBalanceCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">long</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Swing-up and balancing controller for the Quanser Cart-Pole</p>
<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.K_pd">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">K_pd</span></code><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.K_pd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the controller output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>controller output [V]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_e">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">k_e</span></code><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_p">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">k_p</span></code><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.k_p" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'qcp-sub'</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.u_max">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">u_max</span></code><a class="headerlink" href="#pyrado.policies.special.environment_specific.QCartPoleSwingUpAndBalanceCtrl.u_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QQubeEnergyCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_gain</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_gain</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_max</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Energy-based controller used to swing the pendulum up</p>
<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_gain">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">E_gain</span></code><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_gain" title="Permalink to this definition">¶</a></dt>
<dd><p>Called <span class="math notranslate nohighlight">\(\mu\)</span> by Quanser.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_ref">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">E_ref</span></code><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.E_ref" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Control step of energy-based controller which is used in the swing-up controller</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observations pre-processed in the <cite>forward</cite> method of <cite>QQubeSwingUpAndBalanceCtrl</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeEnergyCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.environment_specific.QQubeEnergyCtrl.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeEnergyCtrl.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QQubeGoToLimCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QQubeGoToLimCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnt_done</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeGoToLimCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeGoToLimCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Controller for going to one of the joint limits (part of the calibration routine)</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QQubePDCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QQubePDCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_gains</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">tensor([4.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0,</span> <span class="pre">0.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_des</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">al_des</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tols</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">tensor([0.0262,</span> <span class="pre">0.0087,</span> <span class="pre">0.0017,</span> <span class="pre">0.0017],</span> <span class="pre">dtype=torch.float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubePDCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>PD-controller for the Quanser Qube.
Drives Qube to <span class="math notranslate nohighlight">\(x_{des} = [\theta_{des}, \alpha_{des}, 0.0, 0.0]\)</span>.
Flag done is set when <span class="math notranslate nohighlight">\(|x_des - x| &lt; tol\)</span>.</p>
<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubePDCtrl.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubePDCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubePDCtrl.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubePDCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.environment_specific.QQubePDCtrl.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubePDCtrl.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">QQubeSwingUpAndBalanceCtrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_gain</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_th_gain</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_max</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_max_pd_enable</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_gains</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">tensor([-</span> <span class="pre">2.0,</span> <span class="pre">35.0,</span> <span class="pre">-</span> <span class="pre">1.5,</span> <span class="pre">3.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Hybrid controller (QQubeEnergyCtrl, QQubePDCtrl) switching based on the pendulum pole angle alpha</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Extracted Quanser’s values from q_qube2_swingup.mdl</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">None._VariableFunctionsClass.tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'qq-sub'</span></em><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled">
<code class="sig-name descname"><span class="pre">pd_enabled</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cos_al:</span> <span class="pre">[&lt;class</span> <span class="pre">'float'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'torch.Tensor'&gt;]</span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#QQubeSwingUpAndBalanceCtrl.pd_enabled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the PD-controller should be enabled based oin a predefined threshold on the alpha angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cos_al</strong> – cosine of the pendulum pole angle</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool if condition is met</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.special.environment_specific.get_lin_ctrl">
<code class="sig-name descname"><span class="pre">get_lin_ctrl</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv"><span class="pre">pyrado.environments.sim_base.SimEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ball_z_dim_mismatch</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="policies.feed_forward.html#pyrado.policies.feed_forward.linear.LinearPolicy" title="pyrado.policies.feed_forward.linear.LinearPolicy"><span class="pre">pyrado.policies.feed_forward.linear.LinearPolicy</span></a><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#get_lin_ctrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.get_lin_ctrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a linear controller specified by its controller gains.
Parameters for BallOnPlate5DSim by Markus Lamprecht (clipped gains &lt; 1e-5 to 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment</p></li>
<li><p><strong>ctrl_type</strong> – type of the controller: ‘lqr’, or ‘h2’</p></li>
<li><p><strong>ball_z_dim_mismatch</strong> – only useful for BallOnPlate5DSim
set to True if the given controller dos not have the z component (relative position)
of the ball in the state vector, i.e. state is 14-dim instead of 16-dim</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>controller compatible with Pyrado Policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.special.environment_specific.wam_jsp_7dof_sin">
<code class="sig-name descname"><span class="pre">wam_jsp_7dof_sin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_sign</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/environment_specific.html#wam_jsp_7dof_sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.environment_specific.wam_jsp_7dof_sin" title="Permalink to this definition">¶</a></dt>
<dd><p>A sin-based excitation function for the 7-DoF WAM, describing desired a desired joint angle offset and its velocity
at every point in time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – time</p></li>
<li><p><strong>flip_sign</strong> – if <cite>True</cite>, flip the sign</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>joint angle positions and velocities</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.special.mdn">
<span id="mdn"></span><h2>mdn<a class="headerlink" href="#module-pyrado.policies.special.mdn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.special.mdn.MDNPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">MDNPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_comp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_sizes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_nonlin</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="p"><span class="pre">[</span></span><span class="pre">typing.Callable</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Callable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_param_kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/mdn.html#MDNPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Conditional Mixture of Densities Network (MDN) using multivariate Gaussian distributions as presented in [1]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt>[1] G. Papamakarios, I. Murray. “Fast epsilon-free inference of simulation models with Bayesian conditional</dt><dd><p>density estimation.”, NIPS, 2016</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt id="pyrado.policies.special.mdn.MDNPolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/pyrado/policies/special/mdn.html#MDNPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.mdn.MDNPolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/mdn.html#MDNPolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.mdn.MDNPolicy.log_prob">
<code class="sig-name descname"><span class="pre">log_prob</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/mdn.html#MDNPolicy.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy.log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the log-probability of the mixture of experts.
The posterior is normalized TODO: check this</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – sample y for which the log-probability should be calculated</p></li>
<li><p><strong>x</strong> – a condition</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TODO</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.mdn.MDNPolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'mdn'</span></em><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.mdn.MDNPolicy.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/mdn.html#MDNPolicy.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy.sample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.mdn.MDNPolicy.set_default_x">
<code class="sig-name descname"><span class="pre">set_default_x</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/mdn.html#MDNPolicy.set_default_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.mdn.MDNPolicy.set_default_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a default posterior condition. This function mimics the one from the sbi package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – condition</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.special.time">
<span id="time"></span><h2>time<a class="headerlink" href="#module-pyrado.policies.special.time" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.special.time.PlaybackPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">PlaybackPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_recordings</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_reset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#PlaybackPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>A policy wish simply replays a sequence of actions. If more actions are requested, the policy</p>
<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.curr_rec">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">curr_rec</span></code><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.curr_rec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pointer to the current recording.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.curr_step">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">curr_step</span></code><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.curr_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of the current replay step (0 for the initial step).</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#PlaybackPolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#PlaybackPolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.time.PlaybackPolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'pb'</span></em><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#PlaybackPolicy.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the policy to it’s initial state.
This should be called at the start of a rollout. Stateful policies should use it to reset the state variables.
The default implementation does nothing.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.reset_curr_rec">
<code class="sig-name descname"><span class="pre">reset_curr_rec</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#PlaybackPolicy.reset_curr_rec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.reset_curr_rec" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the pointer to the current recording.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.PlaybackPolicy.script">
<code class="sig-name descname"><span class="pre">script</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.jit._script.ScriptModule</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#PlaybackPolicy.script"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.PlaybackPolicy.script" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScriptModule from this policy.
The returned module will always have the signature <cite>action = tm(observation)</cite>.
For recurrent networks, it returns a stateful module that keeps the hidden states internally.
Such modules have a reset() method to reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.time.TimePolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">TimePolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_of_time</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TimePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TimePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>A purely time-based policy, mainly useful for testing</p>
<dl class="py method">
<dt id="pyrado.policies.special.time.TimePolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TimePolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TimePolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
<li><p><strong>kwargs</strong> – inputs, e.g. an observation from the environment or an observation and a hidden state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs, e.g. an action or an action and a hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.TimePolicy.init_param">
<code class="sig-name descname"><span class="pre">init_param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TimePolicy.init_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TimePolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.time.TimePolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'time'</span></em><a class="headerlink" href="#pyrado.policies.special.time.TimePolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.TimePolicy.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TimePolicy.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TimePolicy.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the policy to it’s initial state.
This should be called at the start of a rollout. Stateful policies should use it to reset the state variables.
The default implementation does nothing.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.TimePolicy.script">
<code class="sig-name descname"><span class="pre">script</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.jit._script.ScriptModule</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TimePolicy.script"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TimePolicy.script" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScriptModule from this policy.
The returned module will always have the signature <cite>action = tm(observation)</cite>.
For recurrent networks, it returns a stateful module that keeps the hidden states internally.
Such modules have a reset() method to reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.special.time.TraceableTimePolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">TraceableTimePolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec"><span class="pre">pyrado.utils.data_types.EnvSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_of_time</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TraceableTimePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A scriptable version of TimePolicy.</p>
<p>We could try to make TimePolicy itself scriptable, but that won’t work anyways due to Policy not being scriptable.
Better to just write another class.</p>
<dl class="py attribute">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.current_time">
<code class="sig-name descname"><span class="pre">current_time</span></code><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.current_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.dt">
<code class="sig-name descname"><span class="pre">dt</span></code><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torch.Tensor</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TraceableTimePolicy.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.input_size">
<code class="sig-name descname"><span class="pre">input_size</span></code><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.input_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'trtime'</span></em><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.output_size">
<code class="sig-name descname"><span class="pre">output_size</span></code><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.special.time.TraceableTimePolicy.reset">
<code class="sig-name descname"><span class="pre">reset</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/special/time.html#TraceableTimePolicy.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrado.policies.special.time.TraceableTimePolicy.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.special">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.policies.special" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="logger.html" class="btn btn-neutral float-right" title="logger" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="policies.recurrent.html" class="btn btn-neutral float-left" title="recurrent" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>