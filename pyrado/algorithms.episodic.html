

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>episodic &mdash; Pyrado 0.4 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="step_based" href="algorithms.step_based.html" />
    <link rel="prev" title="algorithms" href="algorithms.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_basic_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_wrapping_environments.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm_skeleton.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">episodic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.cem">cem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.hc">hc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.nes">nes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.parameter_exploring">parameter_exploring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.pepg">pepg</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.power">power</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.predefined_lqr">predefined_lqr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.reps">reps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic.sysid_via_episodic_rl">sysid_via_episodic_rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.episodic">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.step_based.html">step_based</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.meta.html">meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
</ul>
<p class="caption"><span class="caption-text">Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.barrett_wam.html">barrett_wam</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.feed_forward.html">feed_forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.recurrent.html">recurrent</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.special.html">special</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>episodic</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/algorithms.episodic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="episodic">
<h1>episodic<a class="headerlink" href="#episodic" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.algorithms.episodic.cem">
<span id="cem"></span><h2>cem<a class="headerlink" href="#module-pyrado.algorithms.episodic.cem" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.cem.CEM">
<em class="property">class </em><code class="sig-name descname">CEM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_is_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">extra_expl_std_init</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">extra_expl_decay_iter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">full_cov</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/cem.html#CEM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.cem.CEM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Cross-Entropy Method (CEM)
This implementation is basically Algorithm 3.3. in [1] with the addition of decreasing noise [2].
CEM is closely related to PoWER. The most significant difference is that the importance sampels are not kept over
iterations and that the covariance matrix is not scaled with the returns, thus allowing for negative returns.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] P.T. de Boer, D.P. Kroese, S. Mannor, R.Y. Rubinstein, “A Tutorial on the Cross-Entropy Method”,
Annals OR, 2005
[2] I. Szita, A. Lörnicz, “Learning Tetris Using the NoisyCross-Entropy Method”, Neural Computation, 2006</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.cem.CEM.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'cem'</em><a class="headerlink" href="#pyrado.algorithms.episodic.cem.CEM.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.cem.CEM.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/cem.html#CEM.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.cem.CEM.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.hc">
<span id="hc"></span><h2>hc<a class="headerlink" href="#module-pyrado.algorithms.episodic.hc" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.hc.HC">
<em class="property">class </em><code class="sig-name descname">HC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_factor</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Hill Climbing (HC)</p>
<p>HC is a heuristic-based policy search method that samples a population of policy parameters per iteration
and evaluates them on multiple rollouts. If one of the new parameters is better than the current one it is kept.
If the exploration parameters grow too large, they are reset.</p>
<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.hc.HC.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'hc'</em><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HC.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.hc.HC.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HC.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HC.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.hc.HC.update_expl_strat">
<em class="property">abstract </em><code class="sig-name descname">update_expl_strat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets_avg_ros</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HC.update_expl_strat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HC.update_expl_strat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.episodic.hc.HCHyper">
<em class="property">class </em><code class="sig-name descname">HCHyper</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HCHyper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HCHyper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.hc.HC" title="pyrado.algorithms.episodic.hc.HC"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.hc.HC</span></code></a></p>
<p>Hill Climbing variant using an exploration strategy that samples policy parameters from a hyper-sphere</p>
<dl class="py method">
<dt id="pyrado.algorithms.episodic.hc.HCHyper.update_expl_strat">
<code class="sig-name descname">update_expl_strat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets_avg_ros</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HCHyper.update_expl_strat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HCHyper.update_expl_strat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.episodic.hc.HCNormal">
<em class="property">class </em><code class="sig-name descname">HCNormal</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HCNormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HCNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.hc.HC" title="pyrado.algorithms.episodic.hc.HC"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.hc.HC</span></code></a></p>
<p>Hill Climbing variant using an exploration strategy with normally distributed noise on the policy parameters</p>
<dl class="py method">
<dt id="pyrado.algorithms.episodic.hc.HCNormal.update_expl_strat">
<code class="sig-name descname">update_expl_strat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets_avg_ros</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/hc.html#HCNormal.update_expl_strat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.hc.HCNormal.update_expl_strat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.nes">
<span id="nes"></span><h2>nes<a class="headerlink" href="#module-pyrado.algorithms.episodic.nes" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.nes.NES">
<em class="property">class </em><code class="sig-name descname">NES</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eta_mean</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">eta_std</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transform_returns</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/nes.html#NES"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.nes.NES" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Simplified variant of Natural Evolution Strategies (NES)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] D. Wierstra, T. Schaul, T. Glasmachers, Y. Sun, J. Peters, J. Schmidhuber, “Natural Evolution Strategies”,
JMLR, 2014</p>
<p>[2] This implementation was inspired by <a class="reference external" href="https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/snes.py">https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/snes.py</a></p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.episodic.nes.NES.compute_utilities">
<em class="property">static </em><code class="sig-name descname">compute_utilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">eta_mean</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">eta_std</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/nes.html#NES.compute_utilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.nes.NES.compute_utilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the utilities as described in section 3.1 of [1] (a.k.a. Hansen ranking with uniform baseline)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pop_size</strong> – number of solutions in the population</p></li>
<li><p><strong>eta_mean</strong> – step size factor for the mean</p></li>
<li><p><strong>eta_std</strong> – step size factor for the standard deviation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>utility coefficient for the mean, and utility coefficient for the standard deviation</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.nes.NES.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'nes'</em><a class="headerlink" href="#pyrado.algorithms.episodic.nes.NES.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.nes.NES.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/nes.html#NES.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.nes.NES.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.parameter_exploring">
<span id="parameter-exploring"></span><h2>parameter_exploring<a class="headerlink" href="#module-pyrado.algorithms.episodic.parameter_exploring" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring">
<em class="property">class </em><code class="sig-name descname">ParameterExploring</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/parameter_exploring.html#ParameterExploring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Base for all algorithms that explore directly in the policy parameter space</p>
<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.env">
<em class="property">property </em><code class="sig-name descname">env</code><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.env" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the environment in which the algorithm exploration trains.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/parameter_exploring.html#ParameterExploring.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/parameter_exploring.html#ParameterExploring.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/parameter_exploring.html#ParameterExploring.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/episodic/parameter_exploring.html#ParameterExploring.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the average reward of the mean policy did not change more than the specified threshold over the
last iterations.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.update">
<em class="property">abstract </em><code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/parameter_exploring.html#ParameterExploring.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.pepg">
<span id="pepg"></span><h2>pepg<a class="headerlink" href="#module-pyrado.algorithms.episodic.pepg" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.pepg.PEPG">
<em class="property">class </em><code class="sig-name descname">PEPG</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">clip_ratio_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">normalize_update</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transform_returns</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">lr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0005</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/pepg.html#PEPG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.pepg.PEPG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Parameter-Exploring Policy Gradients (PEPG)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] F. Sehnke, C. Osendorfer, T. Rueckstiess, A. Graves, J. Peters, J. Schmidhuber, “Parameter-exploring
Policy Gradients”, Neural Networks, 2010</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.pepg.PEPG.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'pepg'</em><a class="headerlink" href="#pyrado.algorithms.episodic.pepg.PEPG.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.pepg.PEPG.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/pepg.html#PEPG.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.pepg.PEPG.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.episodic.pepg.rank_transform">
<code class="sig-name descname">rank_transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arr</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">centered</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/pyrado/algorithms/episodic/pepg.html#rank_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.pepg.rank_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a 1-dim ndarray with arbitrary scalar values to an array with equally spaced rank values.
This is a nonlinear transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> – input array</p></li>
<li><p><strong>centered</strong> – if the transform should by centered around zero</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>transformed array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.power">
<span id="power"></span><h2>power<a class="headerlink" href="#module-pyrado.algorithms.episodic.power" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.power.PoWER">
<em class="property">class </em><code class="sig-name descname">PoWER</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_is_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/power.html#PoWER"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.power.PoWER" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Return-based variant of Policy learning by Weighting Exploration with the Returns (PoWER)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PoWER was designed for linear policies.
PoWER is must use positive reward functions (improper probability distribution) [1, p.10].
The original implementation is tailored to movement primitives like DMPs.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Kober and J. Peters, “Policy Search for Motor Primitives in Robotics”, Machine Learning, 2011</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.power.PoWER.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'power'</em><a class="headerlink" href="#pyrado.algorithms.episodic.power.PoWER.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.power.PoWER.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/power.html#PoWER.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.power.PoWER.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.power.PoWER.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/power.html#PoWER.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.power.PoWER.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.predefined_lqr">
<span id="predefined-lqr"></span><h2>predefined_lqr<a class="headerlink" href="#module-pyrado.algorithms.episodic.predefined_lqr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.predefined_lqr.LQR">
<em class="property">class </em><code class="sig-name descname">LQR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv">pyrado.environments.sim_base.SimEnv</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">min_rollouts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_steps</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ball_z_dim_mismatch</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/predefined_lqr.html#LQR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.predefined_lqr.LQR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Linear Quadratic Regulator created using the control module</p>
<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.predefined_lqr.LQR.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'lqr'</em><a class="headerlink" href="#pyrado.algorithms.episodic.predefined_lqr.LQR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.predefined_lqr.LQR.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/predefined_lqr.html#LQR.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.predefined_lqr.LQR.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.predefined_lqr.LQR.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/predefined_lqr.html#LQR.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.predefined_lqr.LQR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.predefined_lqr.LQR.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/episodic/predefined_lqr.html#LQR.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.predefined_lqr.LQR.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the all eigenvalues of the closed loop system are negative.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.reps">
<span id="reps"></span><h2>reps<a class="headerlink" href="#module-pyrado.algorithms.episodic.reps" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.reps.REPS">
<em class="property">class </em><code class="sig-name descname">REPS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">eps</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">num_init_states_per_domain</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">num_domains</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_epoch_dual</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">softmax_transform</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_map</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">optim_mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'scipy'</span></em>, <em class="sig-param"><span class="n">lr_dual</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0005</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Episodic variant of Relative Entropy Policy Search (REPS)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>REPS was designed for linear policies.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Peters, K. Mülling, Y. Altuen, “Relative Entropy Policy Search”, AAAI, 2010
[2] A. Abdolmaleki, J.T. Springenberg, J. Degrave, S. Bohez, Y. Tassa, D. Belov, N. Heess, M. Riedmiller,</p>
<blockquote>
<div><p>“Relative Entropy Regularized Policy Iteration”, arXiv, 2018</p>
</div></blockquote>
<dl class="simple">
<dt>[3] This implementation is inspired by the work of H. Abdulsamad</dt><dd><p><a class="reference external" href="https://github.com/hanyas/rl/blob/master/rl/ereps/ereps.py">https://github.com/hanyas/rl/blob/master/rl/ereps/ereps.py</a></p>
</dd>
</dl>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.dual_evaluation">
<code class="sig-name descname">dual_evaluation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rets</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.dual_evaluation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.dual_evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the REPS dual function value for policy evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta</strong> – lagrangian multiplier (optimization variable of the dual)</p></li>
<li><p><strong>rets</strong> – return values per policy sample after averaging over multiple rollouts using the same policy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dual loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.dual_improvement">
<code class="sig-name descname">dual_improvement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>torch.Tensor<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.dual_improvement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.dual_improvement" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the REPS dual function value for policy improvement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta</strong> – lagrangian multiplier (optimization variable of the dual)</p></li>
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dual loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.eta">
<em class="property">property </em><code class="sig-name descname">eta</code><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Lagrange multiplier <span class="math notranslate nohighlight">\(\eta\)</span>. In [2], <span class="math notranslate nohighlight">\(/eta\)</span> is called <span class="math notranslate nohighlight">\(/alpha\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.minimize">
<code class="sig-name descname">minimize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loss_fcn</span><span class="p">:</span> <span class="n">Callable</span></em>, <em class="sig-param"><span class="n">rets</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.minimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize the given dual function. Iterate <cite>num_epoch_dual</cite> times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_fcn</strong> – function to minimize, different for <cite>wml()</cite> and <cite>wmap()</cite></p></li>
<li><p><strong>rets</strong> – return values per policy sample after averaging over multiple rollouts using the same policy</p></li>
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.reps.REPS.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'reps'</em><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.weights">
<code class="sig-name descname">weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the wights which are used to weights thy policy samples by their return.
As stated in [2, sec 4.1], we could calculate weights using any rank preserving transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rets</strong> – return values per policy sample after averaging over multiple rollouts using the same policy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights of the policy parameter samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.wmap">
<code class="sig-name descname">wmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.wmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.wmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted maximum a-posteriori likelihood update of the policy’s mean and the exploration strategy’s covariance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.reps.REPS.wml">
<code class="sig-name descname">wml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eta</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/reps.html#REPS.wml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.reps.REPS.wml" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted maximum likelihood update of the policy’s mean and the exploration strategy’s covariance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta</strong> – lagrangian multiplier (optimization variable of the dual)</p></li>
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic.sysid_via_episodic_rl">
<span id="sysid-via-episodic-rl"></span><h2>sysid_via_episodic_rl<a class="headerlink" href="#module-pyrado.algorithms.episodic.sysid_via_episodic_rl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL">
<em class="property">class </em><code class="sig-name descname">SysIdViaEpisodicRL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subrtn</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.episodic.parameter_exploring.ParameterExploring" title="pyrado.algorithms.episodic.parameter_exploring.ParameterExploring">pyrado.algorithms.episodic.parameter_exploring.ParameterExploring</a></span></em>, <em class="sig-param"><span class="n">behavior_policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">num_rollouts_per_distr</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">metric</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>numpy.ndarray<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">obs_dim_weight</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">std_obs_filt</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">w_abs</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">w_sq</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">base_seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="algorithms.html#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Wrapper to frame black-box system identification as an episodic reinforcement learning problem</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This algorithm was designed as a subroutine of SimOpt. However, it could also be used independently.</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'sysiderl_iteration'</em><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.loss_fcn">
<code class="sig-name descname">loss_fcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout_real</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">rollout_sim</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.loss_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.loss_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the discrepancy between two time sequences of observations given metric.
Be sure to align and truncate the rollouts beforehand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout_real</strong> – (concatenated) real-world rollout containing the observations</p></li>
<li><p><strong>rollout_sim</strong> – (concatenated) simulated rollout containing the observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>discrepancy cost summed over the observation dimensions</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'sysiderl'</em><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.override_obs_bounds">
<em class="property">static </em><code class="sig-name descname">override_obs_bounds</code><span class="sig-paren">(</span><em class="sig-param">bound_lo: numpy.ndarray</em>, <em class="sig-param">bound_up: numpy.ndarray</em>, <em class="sig-param">labels: numpy.ndarray) -&gt; (&lt;class 'numpy.ndarray'&gt;</em>, <em class="sig-param">&lt;class 'numpy.ndarray'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.override_obs_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.override_obs_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Default overriding method for the bounds of an observation space. This is necessary when the observations
are scaled with their range, e.g. to compare a deviation over different kinds of abservations like position and
annular velocity. Thus, infinite bounds are not feasible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bound_lo</strong> – lower bound of the observation space</p></li>
<li><p><strong>bound_up</strong> – upper bound of the observation space</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>clipped lower and upper bound</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.subrtn">
<em class="property">property </em><code class="sig-name descname">subrtn</code><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.subrtn" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the subroutine used for updating the domain parameter distribution.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.truncate_rollouts">
<em class="property">static </em><code class="sig-name descname">truncate_rollouts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts_real</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rollouts_sim</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">replicate</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.truncate_rollouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.truncate_rollouts" title="Permalink to this definition">¶</a></dt>
<dd><p>In case (some of the) rollouts failed or succeed in one domain, but not in the other, we truncate the longer
observation sequence. When truncating, we compare every of the M real rollouts to every of the N simulated
rollouts, thus replicate the real rollout N times and the simulated rollouts M times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – M real-world rollouts of different length if <cite>replicate = True</cite>, else K real-world
rollouts of different length</p></li>
<li><p><strong>rollouts_sim</strong> – N simulated rollouts of different length if <cite>replicate = True</cite>, else K simulated
rollouts of different length</p></li>
<li><p><strong>replicate</strong> – if <cite>False</cite> the i-th rollout from <cite>rollouts_real</cite> is (only) compared with the i-th rollout from
<cite>rollouts_sim</cite>, in this case the number of rollouts and the initial states have to match</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MxN real-world rollouts and MxN simulated rollouts of equal length if <cite>replicate = True</cite>, else
K real-world rollouts and K simulated rollouts of equal length</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.weighted_l1_l2_metric">
<em class="property">static </em><code class="sig-name descname">weighted_l1_l2_metric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">err</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">w_abs</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">w_sq</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">obs_dim_weight</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/episodic/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.weighted_l1_l2_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.episodic.sysid_via_episodic_rl.SysIdViaEpisodicRL.weighted_l1_l2_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the weighted linear combination of the observation error’s MAE and MSE, averaged over time</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In contrast to [1], we are using the mean absolute error and the mean squared error instead of the L1 and
the L2 norm. The reason for this is that longer time series would be punished otherwise.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>err</strong> – error signal with time steps along the first dimension</p></li>
<li><p><strong>w_abs</strong> – weight for the mean absolute errors</p></li>
<li><p><strong>w_sq</strong> – weight for the mean squared errors</p></li>
<li><p><strong>obs_dim_weight</strong> – (diagonal) weight matrix for the different observation dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted linear combination of the error’s MAE and MSE, averaged over time</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.episodic">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms.episodic" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="algorithms.step_based.html" class="btn btn-neutral float-right" title="step_based" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="algorithms.html" class="btn btn-neutral float-left" title="algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>